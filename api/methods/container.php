<?php$route = '/org/';$app->get($route, function ()  use ($app){	$ReturnObject = array();	if(isset($_REQUEST['query'])){ $query = $_REQUEST['query']; } else { $query = '';}				// Pull from MySQL	if($query=='')		{		$Query = "SELECT * FROM org WHERE name LIKE '%" . $query . "%'";		}	else {
		$Query = "SELECT * FROM org";		
	}	$Query .= " ORDER BY name ASC";	//echo $Query . "<br />";		$PressResult = mysql_query($Query) or die('Query failed: ' . mysql_error());	  	while ($Press = mysql_fetch_assoc($PressResult))		{		$name = $Press['name'];		$address = $Press['address'];		$contactTelephone = $Press['contactTelephone'];		$contactName = $Press['contactName'];		$department = $Press['department'];		$email = $Press['email'];		$faxNumber = $Press['faxNumber'];		$logo = $Press['logo'];		$telephone = $Press['telephone'];		$taxId = $Press['taxId'];		$url = $Press['url'];		$description = $Press['description'];			$sameAs = $Press['sameAs'];		$legalName = $Press['legalName'];		$slug = $Press['slug'];						// manipulation zone				$F = array();		$F['name'] = $name;		$F['address'] = $address;		$F['contactTelephone'] = $contactTelephone;		$F['contactName'] = $contactName;		$F['department'] = $department;		$F['email'] = $email;		$F['faxNumber'] = $faxNumber;		$F['logo'] = $logo;		$F['telephone'] = $telephone;		$F['taxId'] = $taxId;		$F['url'] = $url;		$F['description'] = $description;		$F['sameAs'] = $sameAs;		$F['legalName'] = $legalName;		$F['slug'] = $slug;				array_push($ReturnObject, $F);		}		$app->response()->header("Content-Type", "application/json");		echo stripslashes(format_json(json_encode($ReturnObject)));	});$route = '/org/:slug/';$app->get($route, function ($slug)  use ($app){	$ReturnObject = array();			$Query = "SELECT * FROM org WHERE slug = '" . $slug . "'";	$Query .= " ORDER BY name ASC";	//echo $Query . "<br />";		$PressResult = mysql_query($Query) or die('Query failed: ' . mysql_error());	  	while ($Press = mysql_fetch_assoc($PressResult))		{		$name = $Press['name'];		$address = $Press['address'];		$contactTelephone = $Press['contactTelephone'];		$contactName = $Press['contactName'];		$department = $Press['department'];		$email = $Press['email'];		$faxNumber = $Press['faxNumber'];		$logo = $Press['logo'];		$telephone = $Press['telephone'];		$taxId = $Press['taxId'];		$url = $Press['url'];		$description = $Press['description'];			$sameAs = $Press['sameAs'];		$legalName = $Press['legalName'];		$slug = $Press['slug'];						// manipulation zone				$F = array();		$F['name'] = $name;		$F['address'] = $address;		$F['contactTelephone'] = $contactTelephone;		$F['contactName'] = $contactName;		$F['department'] = $department;		$F['email'] = $email;		$F['faxNumber'] = $faxNumber;		$F['logo'] = $logo;		$F['telephone'] = $telephone;		$F['taxId'] = $taxId;		$F['url'] = $url;		$F['description'] = $description;		$F['sameAs'] = $sameAs;		$F['legalName'] = $legalName;		$F['slug'] = $slug;				array_push($ReturnObject, $F);		}		$app->response()->header("Content-Type", "application/json");		echo stripslashes(format_json(json_encode($ReturnObject)));	});	$route = '/org/';	$app->post($route, function () use ($app){		$Add = 1;	$ReturnObject = array();	 	$request = $app->request();  	$_POST = $request->params();			if(isset($_POST['name'])){ $name = $_POST['name']; } elseif(isset($_POST['name'])){ $name = $_REQUEST['name']; } else { $name = ''; }	if(isset($_POST['slug'])){ $name = $_POST['slug']; } elseif(isset($_POST['slug'])){ $slug = $_REQUEST['slug']; } else { $slug = ''; }		  	$LinkQuery = "SELECT * FROM org WHERE name = '" . $name . "'";	//echo $LinkQuery . "<br />";	$LinkResult = mysql_query($LinkQuery) or die('Query failed: ' . mysql_error());		if($LinkResult && mysql_num_rows($LinkResult))		{			$Link = mysql_fetch_assoc($LinkResult);			}	else 		{		$query = "INSERT INTO org(name) VALUES('" . mysql_real_escape_string($name) . "')";		//echo $query . "<br />";		mysql_query($query) or die('Query failed: ' . mysql_error());					}	});	$route = '/org/:slug/';	$app->put($route, function () use ($app){		$ReturnObject = array();	 	$request = $app->request();  	$_POST = $request->params();			if(isset($_POST['name'])){ $name = $_POST['name']; } elseif(isset($_POST['name'])){ $name = $_REQUEST['name']; } else { $name = ''; }		if(isset($_POST['slug'])){ $slug = $_POST['slug']; } elseif(isset($_POST['slug'])){ $slug = $_REQUEST['slug']; } else { $slug = ''; }  	$LinkQuery = "SELECT * FROM org WHERE name = '" . $name . "' AND slug = '" . $slug . "'";	//echo $LinkQuery . "<br />";	$LinkResult = mysql_query($LinkQuery) or die('Query failed: ' . mysql_error());		if($LinkResult && mysql_num_rows($LinkResult))		{			$query = "UPDATE org name = '" . mysql_real_escape_string($name) . "' WHERE slug = '" . $slug . "'";		//echo $query . "<br />";		mysql_query($query) or die('Query failed: ' . mysql_error());			}	});	$route = '/org/';	$app->delete($route, function () use ($app){		$Add = 1;	$ReturnObject = array();	 	$request = $app->request();  	$_POST = $request->params();			if(isset($_POST['slug'])){ $slug = $_POST['slug']; } elseif(isset($_POST['slug'])){ $slug = $_REQUEST['slug']; } else { $slug = ''; }	$query = "DELETE FROM org WHERE slug = '" . $slug . "'";	//echo $query . "<br />";	mysql_query($query) or die('Query failed: ' . mysql_error());		});			?>